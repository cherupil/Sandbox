(()=>{var et=`attribute vec4 aPosition;

uniform mat4 uMatrix;
uniform float uTime;

void main() {
	vec4 position = uMatrix * aPosition;
	float zToDivideBy = 1.0 + position.z * 0.0;
	position.x += sin(position.y * 24.0 + (uTime * 1.0)) / 160.0;
	position.y += sin(position.z * 40.0 + (uTime * 1.1)) / 160.0;
	position.z += sin(position.x * 32.0 + (uTime * 1.2)) / 160.0;
	gl_Position = vec4(position.xy / zToDivideBy, position.zw);
}`;var st=`precision mediump float;

uniform vec2 uResolution;
uniform float uRed;
uniform float uGreen;
uniform float uBlue;

void main() {
	vec3 outer = vec3(uRed/2.0, uGreen/4.0, uBlue/4.0);
	vec3 inner = vec3(uRed/8.0, uGreen/16.0, uBlue/16.0);
	vec2 center = vec2(0.5);
	vec2 st = gl_FragCoord.xy/uResolution.xy;
	float dist = distance(st, center) * 8.0;
	vec3 mixed = mix(outer, inner, dist);
	gl_FragColor = vec4(mixed, 1.0);
}`;var ot=`attribute vec4 aPosition;

uniform mat4 uMatrix;
uniform float uTime;

void main() {
	vec4 position = uMatrix * aPosition;
	float zToDivideBy = 1.0 + position.z * 0.0;
	position.x += sin(position.y * 24.0 + (uTime * 1.0)) / 160.0;
	position.y += sin(position.z * 40.0 + (uTime * 1.1)) / 160.0;
	position.z += sin(position.x * 32.0 + (uTime * 1.2)) / 160.0;
	gl_Position = vec4(position.xy / zToDivideBy, position.zw);
}`;var it=`precision mediump float;

uniform float uRed;
uniform float uGreen;
uniform float uBlue;

void main() {
	float sideLength = 0.25;
	float diagonal = sqrt(pow(sideLength, 2.0) + pow(sideLength, 2.0));
	float total = sqrt(pow(diagonal, 2.0) + pow(diagonal, 2.0));
	float diff = ((total / 2.0) + gl_FragCoord.z) / total;
	vec3 front = vec3((1.0 + uRed) - diff, (1.0 + uGreen) - diff, (1.0 + uBlue) - diff);
	vec3 back = vec3(0.0, 0.0, 0.0);
	vec3 final = mix(back, front, 2.25 - diff);
	vec3 depth = vec3(pow(1.0 - diff, 8.0));
	gl_FragColor = vec4(final + depth, 1.0);
}`;var V=class{constructor(t){this.gl=t.getContext("webgl",{powerPreference:"high-performance"}),this.resize=this.resize.bind(this),this.render=this.render.bind(this),this.pixelRatio=2}setPixelRatio(t){this.pixelRatio=t}resize(){let t=this.gl.canvas.clientWidth*this.pixelRatio,e=this.gl.canvas.clientHeight*this.pixelRatio;return this.gl.canvas.width*this.pixel!==t||this.gl.canvas.height*this.pixelRatio!==e?(this.gl.canvas.width=t,this.gl.canvas.height=e,this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),!0):!1}render(t,e){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.enable(this.gl.CULL_FACE),this.gl.enable(this.gl.DEPTH_TEST);let o=null,i=null;for(let r of t.objects){r.setProjectionMatrix(e.matrix);let c=!1;if(r.shader.program!==o&&(this.gl.useProgram(r.shader.program),o=r.shader.program,c=!0),c||r.geometry.attributes!=i){for(let a in r.geometry.attributes){this.gl.enableVertexAttribArray(r.geometry.attributes[a].location),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,r.geometry.attributes[a].buffer);let m=r.geometry.attributes[a].size,d=this.gl.FLOAT,x=!1,v=0,b=0;this.gl.vertexAttribPointer(r.geometry.attributes[a].location,m,d,x,v,b)}i=r.geometry.attributes}for(let a in r.shader.uniforms)if(a==="uMatrix")this.gl.uniformMatrix4fv(r.shader.uniforms[a].location,!1,r.projectionMatrix);else switch(r.shader.uniforms[a].type){case"1f":this.gl.uniform1f(r.shader.uniforms[a].location,r.shader.uniforms[a].value);break;case"2f":this.gl.uniform2f(r.shader.uniforms[a].location,r.shader.uniforms[a].value[0],r.shader.uniforms[a].value[1]);break;case"3f":this.gl.uniform2f(r.shader.uniforms[a].location,r.shader.uniforms[a].value[0],r.shader.uniforms[a].value[1],r.shader.uniforms[a].value[2]);break;case"mat3":this.gl.uniformMatrix3fv(r.shader.uniforms[a].location,!1,r.shader.uniforms[a].value);break;case"mat4":this.gl.uniformMatrix4fv(r.shader.uniforms[a].location,!1,r.shader.uniforms[a].value);break;default:break}let n=this.gl[r.drawMode],f=0,h=r.geometry.attributes.aPosition.count;this.gl.drawArrays(n,f,h)}}};var X=class{constructor(t,e,o,i,r,c){this.left=t,this.right=e,this.bottom=o,this.top=i,this.near=r,this.far=c,this._createMatrix()}_createMatrix(){this.matrix=[2/(this.right-this.left),0,0,0,0,2/(this.top-this.bottom),0,0,0,0,-2/(this.far-this.near),0,-(this.right+this.left)/(this.right-this.left),-(this.top+this.bottom)/(this.top-this.bottom),-(this.far+this.near)/(this.far-this.near),1]}setLeft(t){this.left=t,this._createMatrix()}setRight(t){this.right=t,this._createMatrix()}setBottom(t){this.bottom=t,this._createMatrix()}setTop(t){this.top=t,this._createMatrix()}setNear(t){this.near=t,this._createMatrix()}setFar(t){this.far=t,this._createMatrix()}};var N=class{constructor(){this.objects=[]}add(t){this.objects.push(t),this.objects.sort((e,o)=>{let i=e.geometry.id-o.geometry.id;return i||e.shader.id-o.shader.id})}};var p=class{static multiply(t,e){let o=e[0*4+0],i=e[0*4+1],r=e[0*4+2],c=e[0*4+3],n=e[1*4+0],f=e[1*4+1],h=e[1*4+2],a=e[1*4+3],m=e[2*4+0],d=e[2*4+1],x=e[2*4+2],v=e[2*4+3],b=e[3*4+0],M=e[3*4+1],P=e[3*4+2],T=e[3*4+3],w=t[0*4+0],y=t[0*4+1],R=t[0*4+2],_=t[0*4+3],s=t[1*4+0],A=t[1*4+1],B=t[1*4+2],E=t[1*4+3],F=t[2*4+0],S=t[2*4+1],D=t[2*4+2],L=t[2*4+3],k=t[3*4+0],O=t[3*4+1],Y=t[3*4+2],H=t[3*4+3];return[o*w+i*s+r*F+c*k,o*y+i*A+r*S+c*O,o*R+i*B+r*D+c*Y,o*_+i*E+r*L+c*H,n*w+f*s+h*F+a*k,n*y+f*A+h*S+a*O,n*R+f*B+h*D+a*Y,n*_+f*E+h*L+a*H,m*w+d*s+x*F+v*k,m*y+d*A+x*S+v*O,m*R+d*B+x*D+v*Y,m*_+d*E+x*L+v*H,b*w+M*s+P*F+T*k,b*y+M*A+P*S+T*O,b*R+M*B+P*D+T*Y,b*_+M*E+P*L+T*H]}static identity(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}static translate(t,e,o){return[1,0,0,0,0,1,0,0,0,0,1,0,t,e,o,1]}static rotateX(t){let e=t*Math.PI/180,o=Math.cos(e),i=Math.sin(e);return[1,0,0,0,0,o,i,0,0,-i,o,0,0,0,0,1]}static rotateY(t){let e=t*Math.PI/180,o=Math.cos(e),i=Math.sin(e);return[o,0,-i,0,0,1,0,0,i,0,o,0,0,0,0,1]}static rotateZ(t){let e=t*Math.PI/180,o=Math.cos(e),i=Math.sin(e);return[o,i,0,0,-i,o,0,0,0,0,1,0,0,0,0,1]}static scale(t,e,o){return[t,0,0,0,0,e,0,0,0,0,o,0,0,0,0,1]}};var W=class{constructor(t,e){this.geometry=t,this.shader=e,this.position={x:0,y:0,z:0},this.rotation={x:0,y:0,z:0},this.scale={x:1,y:1,z:1},this.localMatrix=p.identity(),this._setAttributeData(),this._setUniformData(),this._setDrawMode()}_setAttributeData(){for(let t in this.geometry.attributes)this.geometry.attributes[t].location=this.shader.gl.getAttribLocation(this.shader.program,this.geometry.attributes[t].name),this.geometry.attributes[t].buffer=this.shader.gl.createBuffer(),this.shader.gl.bindBuffer(this.shader.gl.ARRAY_BUFFER,this.geometry.attributes[t].buffer),this.shader.gl.bufferData(this.shader.gl.ARRAY_BUFFER,this.geometry.attributes[t].data,this.shader.gl.STATIC_DRAW)}_setUniformData(){if(this.shader.uniforms)for(let t in this.shader.uniforms)this.shader.uniforms[t].location=this.shader.gl.getUniformLocation(this.shader.program,this.shader.uniforms[t].name)}_setDrawMode(){this.drawMode=this.geometry.type??"TRIANGLES"}_recalculateModelMatrix(){let t=p.identity(),e=p.translate(this.position.x,this.position.y,this.position.z),o=p.rotateX(this.rotation.x),i=p.rotateY(this.rotation.y),r=p.rotateZ(this.rotation.z),c=p.scale(this.scale.x,this.scale.y,this.scale.z),n=p.multiply(t,e);n=p.multiply(n,o),n=p.multiply(n,i),n=p.multiply(n,r),n=p.multiply(n,c),this.localMatrix=n}setProjectionMatrix(t){this.projectionMatrix=p.multiply(t,this.localMatrix)}setPosition(t,e,o){this.position={x:t,y:e,z:o},this._recalculateModelMatrix()}setRotationX(t){this.rotation.x=t,this._recalculateModelMatrix()}setRotationY(t){this.rotation.y=t,this._recalculateModelMatrix()}setRotationZ(t){this.rotation.z=t,this._recalculateModelMatrix()}setScale(t,e,o){this.scale={x:t,y:e,z:o},this._recalculateModelMatrix()}};var lt=0,z=class{constructor(t){this.id=lt++,this.attributes={},this.setAttribute("aPosition",new Float32Array(t),3)}setAttribute(t,e,o){this.attributes[t]={name:t,data:e,size:o,count:e.length/o}}};var q=class extends z{constructor(t,e,o,i){let r=[],c=t/o,n=e/i;for(let f=0;f<i;f++)for(let h=0;h<o;h++){let a=h*c-t/2,m=f*n-e/2,d=0,x=(h+1)*c-t/2,v=m,b=a,M=(f+1)*n-e/2,P=a,T=M,w=x,y=v,R=x,_=M;r.push(a,m,d,x,v,d,b,M,d,P,T,d,w,y,d,R,_,d)}super(r)}};var Z=class extends z{constructor(t,e){let o=[];o.push(0,0,0);for(let i=0;i<e;i++){let r=Math.cos(i*Math.PI/(e/2))*t,c=Math.sin(i*Math.PI/(e/2))*t,n=0;o.push(r,c,n)}o.push(Math.cos(0)*t,Math.sin(0)*t,0);super(o);this.type="TRIANGLE_FAN"}};var K=class extends z{constructor(t,e,o,i,r,c){let n=[];f("x","y","z",t,e,o,i,r,"front"),f("x","y","z",t,e,-o,i,r,"back"),f("x","z","y",t,o,e,i,c,"back"),f("x","z","y",t,o,-e,i,c,"front"),f("z","y","x",o,e,t,c,r,"back"),f("z","y","x",o,e,-t,c,r,"front");function f(h,a,m,d,x,v,b,M,P){let T=d/b,w=x/M,y=v/2;for(let R=0;R<M;R++)for(let _=0;_<b;_++){let s={};s[h]=[],s[a]=[],s[m]=[];let A=_*T-d/2,B=R*w-x/2,E=(_+1)*T-d/2,F=(R+1)*w-x/2;s[h].push(A),s[a].push(B),s[m].push(y),s[h].push(E),s[a].push(B),s[m].push(y),s[h].push(A),s[a].push(F),s[m].push(y),s[h].push(A),s[a].push(F),s[m].push(y),s[h].push(E),s[a].push(B),s[m].push(y),s[h].push(E),s[a].push(F),s[m].push(y),P==="front"?n.push(s.x[0],s.y[0],s.z[0],s.x[1],s.y[1],s.z[1],s.x[2],s.y[2],s.z[2],s.x[3],s.y[3],s.z[3],s.x[4],s.y[4],s.z[4],s.x[5],s.y[5],s.z[5]):P==="back"&&n.push(s.x[0],s.y[0],s.z[0],s.x[2],s.y[2],s.z[2],s.x[1],s.y[1],s.z[1],s.x[3],s.y[3],s.z[3],s.x[5],s.y[5],s.z[5],s.x[4],s.y[4],s.z[4])}}super(n)}};var ht=0,J=class{constructor(t,e,o){let i=this._createShader(t,t.VERTEX_SHADER,e),r=this._createShader(t,t.FRAGMENT_SHADER,o);this.gl=t,this.id=ht++,this.program=this._createProgram(t,i,r),this.uniforms={uMatrix:{name:"uMatrix",value:null,type:"mat4"}}}_createShader(t,e,o){let i=t.createShader(e);if(t.shaderSource(i,o),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS))return i;console.log(t.getShaderInfoLog(i)),t.deleteShader(i)}_createProgram(t,e,o){let i=t.createProgram();if(t.attachShader(i,e),t.attachShader(i,o),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS))return i;console.log(t.getProgramInfoLog(i)),t.deleteProgram(i)}setUniform(t,e,o){this.uniforms[t]={name:t,value:e,type:o}}};var u=class{static createColor(t,e,o){return{r:t/255,g:e/255,b:o/255}}};u.Renderer=V;u.Orthographic=X;u.Volume=N;u.Mesh=W;u.Geometry=z;u.Plane=q;u.Circle=Z;u.Cube=K;u.Program=J;var C=window.innerWidth/window.innerHeight,ft=document.getElementById("webgl"),g=new u.Renderer(ft);g.setPixelRatio(1);var mt=new u.Circle(.5,64),U=new u.Program(g.gl,et,st);U.setUniform("uTime",0,"1f");U.setUniform("uResolution",[g.gl.canvas.width,g.gl.canvas.height],"2f");U.setUniform("uRed",1,"1f");U.setUniform("uGreen",.25,"1f");U.setUniform("uBlue",.5,"1f");var j=new u.Mesh(mt,U);j.setPosition(0,0,.625);var dt=new u.Cube(1,1,1,64,64,64),I=new u.Program(g.gl,ot,it);I.setUniform("uTime",0,"1f");I.setUniform("uRed",1,"1f");I.setUniform("uGreen",.25,"1f");I.setUniform("uBlue",.5,"1f");var G=new u.Mesh(dt,I);G.setRotationX(37.5);G.setRotationY(45);var Q=new u.Volume;Q.add(G);Q.add(j);var $=new u.Orthographic(-1*C,1*C,-1,1,-1,1);g.resize();j.shader.uniforms.uResolution.value=[g.gl.canvas.width,g.gl.canvas.height];g.gl.clearColor(0,0,0,0);var tt=0,rt=()=>{g.render(Q,$),tt+=.1,j.shader.uniforms.uTime.value=tt,G.shader.uniforms.uTime.value=tt,window.requestAnimationFrame(rt)};window.addEventListener("resize",()=>{g.resize()&&(C=g.gl.canvas.width/g.gl.canvas.height,$.setLeft(-1*C),$.setRight(1*C),j.shader.uniforms.uResolution.value=[g.gl.canvas.width,g.gl.canvas.height])});window.requestAnimationFrame(rt);var pt=document.getElementById("red"),gt=document.getElementById("green"),xt=document.getElementById("blue");pt.addEventListener("input",l=>{G.shader.uniforms.uRed.value=l.target.value,j.shader.uniforms.uRed.value=l.target.value});gt.addEventListener("input",l=>{G.shader.uniforms.uGreen.value=l.target.value,j.shader.uniforms.uGreen.value=l.target.value});xt.addEventListener("input",l=>{G.shader.uniforms.uBlue.value=l.target.value,j.shader.uniforms.uBlue.value=l.target.value});})();
