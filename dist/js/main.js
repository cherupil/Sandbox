(()=>{var J=`attribute vec4 aPosition;

uniform mat4 uMatrix;

void main() {
	vec4 position = uMatrix * aPosition;
	gl_Position = position;
}`;var Q=`precision mediump float;

void main() {
	gl_FragColor = vec4(0.015, 0.125, 0.203, 1.0);
}`;var $=`attribute vec4 aPosition;

uniform mat4 uMatrix;
uniform float uTime;

void main() {
	vec4 position = uMatrix * aPosition;
	position.x += sin(position.y * 24.0 + uTime) / 160.0;
	position.y += sin(position.z * 40.0 + uTime) / 160.0;
	position.z += sin(position.x * 32.0 + uTime) / 160.0;
	gl_Position = position;
}`;var tt=`precision mediump float;

void main() {
	float sideLength = 0.25;
	float diagonal = sqrt(pow(sideLength, 2.0) + pow(sideLength, 2.0));
	float total = sqrt(pow(diagonal, 2.0) + pow(diagonal, 2.0));
	float diff = ((total / 2.0) + gl_FragCoord.z) / total;
	vec3 front = vec3(1.375 - diff, 1.75 - diff, 2.0 - diff);
	vec3 back = vec3(0.125, 0.875, 0.25);
	vec3 final = mix(back, front, 2.25 - diff);
	vec3 depth = vec3(pow(1.9 - diff, 8.0));
	gl_FragColor = vec4(final + depth, 1.0);
	//gl_FragColor = vec4(final, 1.0);
}`;var G=class{constructor(t){this.gl=t.getContext("webgl",{powerPreference:"high-performance"}),this.resize=this.resize.bind(this),this.render=this.render.bind(this)}resize(){let t=this.gl.canvas.clientWidth,s=this.gl.canvas.clientHeight;return this.gl.canvas.width!==t||this.gl.canvas.height!==s?(this.gl.canvas.width=t,this.gl.canvas.height=s,this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),!0):!1}render(t,s){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.enable(this.gl.CULL_FACE),this.gl.enable(this.gl.DEPTH_TEST);let o=null,r=null;for(let i of t.objects){i.setProjectionMatrix(s.matrix);let c=!1;if(i.shader.program!==o&&(this.gl.useProgram(i.shader.program),o=i.shader.program,c=!0),c||i.geometry.attributes!=r){for(let a in i.geometry.attributes){this.gl.enableVertexAttribArray(i.geometry.attributes[a].location),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,i.geometry.attributes[a].buffer);let f=i.geometry.attributes[a].size,m=this.gl.FLOAT,p=!1,x=0,b=0;this.gl.vertexAttribPointer(i.geometry.attributes[a].location,f,m,p,x,b)}r=i.geometry.attributes}for(let a in i.shader.uniforms)if(a==="uMatrix")this.gl.uniformMatrix4fv(i.shader.uniforms[a].location,!1,i.projectionMatrix);else switch(i.shader.uniforms[a].type){case"1f":this.gl.uniform1f(i.shader.uniforms[a].location,i.shader.uniforms[a].value);break;case"2f":this.gl.uniform2f(i.shader.uniforms[a].location,i.shader.uniforms[a].value[0],i.shader.uniforms[a].value[1]);break;case"3f":this.gl.uniform2f(i.shader.uniforms[a].location,i.shader.uniforms[a].value[0],i.shader.uniforms[a].value[1],i.shader.uniforms[a].value[2]);break;case"mat3":this.gl.uniformMatrix3fv(i.shader.uniforms[a].location,!1,i.shader.uniforms[a].value);break;case"mat4":this.gl.uniformMatrix4fv(i.shader.uniforms[a].location,!1,i.shader.uniforms[a].value);break;default:break}let n=this.gl[i.drawMode],u=0,l=i.geometry.attributes.aPosition.count;this.gl.drawArrays(n,u,l)}}};var O=class{constructor(t,s,o,r,i,c){this.left=t,this.right=s,this.bottom=o,this.top=r,this.near=i,this.far=c,this._createMatrix()}_createMatrix(){this.matrix=[2/(this.right-this.left),0,0,0,0,2/(this.top-this.bottom),0,0,0,0,-2/(this.far-this.near),0,-(this.right+this.left)/(this.right-this.left),-(this.top+this.bottom)/(this.top-this.bottom),-(this.far+this.near)/(this.far-this.near),1]}setLeft(t){this.left=t,this._createMatrix()}setRight(t){this.right=t,this._createMatrix()}setBottom(t){this.bottom=t,this._createMatrix()}setTop(t){this.top=t,this._createMatrix()}setNear(t){this.near=t,this._createMatrix()}setFar(t){this.far=t,this._createMatrix()}};var Y=class{constructor(){this.objects=[]}add(t){this.objects.push(t),this.objects.sort((s,o)=>{let r=s.geometry.id-o.geometry.id;return r||s.shader.id-o.shader.id})}};var d=class{static multiply(t,s){let o=s[0*4+0],r=s[0*4+1],i=s[0*4+2],c=s[0*4+3],n=s[1*4+0],u=s[1*4+1],l=s[1*4+2],a=s[1*4+3],f=s[2*4+0],m=s[2*4+1],p=s[2*4+2],x=s[2*4+3],b=s[3*4+0],y=s[3*4+1],z=s[3*4+2],R=s[3*4+3],A=t[0*4+0],g=t[0*4+1],M=t[0*4+2],v=t[0*4+3],e=t[1*4+0],w=t[1*4+1],T=t[1*4+2],F=t[1*4+3],j=t[2*4+0],E=t[2*4+1],I=t[2*4+2],B=t[2*4+3],L=t[3*4+0],k=t[3*4+1],D=t[3*4+2],U=t[3*4+3];return[o*A+r*e+i*j+c*L,o*g+r*w+i*E+c*k,o*M+r*T+i*I+c*D,o*v+r*F+i*B+c*U,n*A+u*e+l*j+a*L,n*g+u*w+l*E+a*k,n*M+u*T+l*I+a*D,n*v+u*F+l*B+a*U,f*A+m*e+p*j+x*L,f*g+m*w+p*E+x*k,f*M+m*T+p*I+x*D,f*v+m*F+p*B+x*U,b*A+y*e+z*j+R*L,b*g+y*w+z*E+R*k,b*M+y*T+z*I+R*D,b*v+y*F+z*B+R*U]}static identity(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}static translate(t,s,o){return[1,0,0,0,0,1,0,0,0,0,1,0,t,s,o,1]}static rotateX(t){let s=t*Math.PI/180,o=Math.cos(s),r=Math.sin(s);return[1,0,0,0,0,o,r,0,0,-r,o,0,0,0,0,1]}static rotateY(t){let s=t*Math.PI/180,o=Math.cos(s),r=Math.sin(s);return[o,0,-r,0,0,1,0,0,r,0,o,0,0,0,0,1]}static rotateZ(t){let s=t*Math.PI/180,o=Math.cos(s),r=Math.sin(s);return[o,r,0,0,-r,o,0,0,0,0,1,0,0,0,0,1]}static scale(t,s,o){return[t,0,0,0,0,s,0,0,0,0,o,0,0,0,0,1]}};var H=class{constructor(t,s){this.geometry=t,this.shader=s,this.position={x:0,y:0,z:0},this.rotation={x:0,y:0,z:0},this.scale={x:1,y:1,z:1},this.localMatrix=d.identity(),this._setAttributeData(),this._setUniformData(),this._setDrawMode()}_setAttributeData(){for(let t in this.geometry.attributes)this.geometry.attributes[t].location=this.shader.gl.getAttribLocation(this.shader.program,this.geometry.attributes[t].name),this.geometry.attributes[t].buffer=this.shader.gl.createBuffer(),this.shader.gl.bindBuffer(this.shader.gl.ARRAY_BUFFER,this.geometry.attributes[t].buffer),this.shader.gl.bufferData(this.shader.gl.ARRAY_BUFFER,this.geometry.attributes[t].data,this.shader.gl.STATIC_DRAW)}_setUniformData(){if(this.shader.uniforms)for(let t in this.shader.uniforms)this.shader.uniforms[t].location=this.shader.gl.getUniformLocation(this.shader.program,this.shader.uniforms[t].name)}_setDrawMode(){this.drawMode=this.geometry.type??"TRIANGLES"}_recalculateModelMatrix(){let t=d.identity(),s=d.translate(this.position.x,this.position.y,this.position.z),o=d.rotateX(this.rotation.x),r=d.rotateY(this.rotation.y),i=d.rotateZ(this.rotation.z),c=d.scale(this.scale.x,this.scale.y,this.scale.z),n=d.multiply(t,s);n=d.multiply(n,o),n=d.multiply(n,r),n=d.multiply(n,i),n=d.multiply(n,c),this.localMatrix=n}setProjectionMatrix(t){this.projectionMatrix=d.multiply(t,this.localMatrix)}setPosition(t,s,o){this.position={x:t,y:s,z:o},this._recalculateModelMatrix()}setRotationX(t){this.rotation.x=t,this._recalculateModelMatrix()}setRotationY(t){this.rotation.y=t,this._recalculateModelMatrix()}setRotationZ(t){this.rotation.z=t,this._recalculateModelMatrix()}setScale(t,s,o){this.scale={x:t,y:s,z:o},this._recalculateModelMatrix()}};var ht=0,P=class{constructor(t){this.id=ht++,this.attributes={},this.setAttribute("aPosition",new Float32Array(t),3)}setAttribute(t,s,o){this.attributes[t]={name:t,data:s,size:o,count:s.length/o}}};var V=class extends P{constructor(t,s,o,r){let i=[],c=t/o,n=s/r;for(let u=0;u<r;u++)for(let l=0;l<o;l++){let a=l*c-t/2,f=u*n-s/2,m=0,p=(l+1)*c-t/2,x=f,b=a,y=(u+1)*n-s/2,z=a,R=y,A=p,g=x,M=p,v=y;i.push(a,f,m,p,x,m,b,y,m,z,R,m,A,g,m,M,v,m)}super(i)}};var X=class extends P{constructor(t,s){let o=[];o.push(0,0,0);for(let r=0;r<s;r++){let i=Math.cos(r*Math.PI/(s/2))*t,c=Math.sin(r*Math.PI/(s/2))*t,n=0;o.push(i,c,n)}o.push(Math.cos(0)*t,Math.sin(0)*t,0);super(o);this.type="TRIANGLE_FAN"}};var N=class extends P{constructor(t,s,o,r,i,c){let n=[];u("x","y","z",t,s,o,r,i,"front"),u("x","y","z",t,s,-o,r,i,"back"),u("x","z","y",t,o,s,r,c,"back"),u("x","z","y",t,o,-s,r,c,"front"),u("z","y","x",o,s,t,c,i,"back"),u("z","y","x",o,s,-t,c,i,"front");function u(l,a,f,m,p,x,b,y,z){let R=m/b,A=p/y,g=x/2;for(let M=0;M<y;M++)for(let v=0;v<b;v++){let e={};e[l]=[],e[a]=[],e[f]=[];let w=v*R-m/2,T=M*A-p/2,F=(v+1)*R-m/2,j=(M+1)*A-p/2;e[l].push(w),e[a].push(T),e[f].push(g),e[l].push(F),e[a].push(T),e[f].push(g),e[l].push(w),e[a].push(j),e[f].push(g),e[l].push(w),e[a].push(j),e[f].push(g),e[l].push(F),e[a].push(T),e[f].push(g),e[l].push(F),e[a].push(j),e[f].push(g),z==="front"?n.push(e.x[0],e.y[0],e.z[0],e.x[1],e.y[1],e.z[1],e.x[2],e.y[2],e.z[2],e.x[3],e.y[3],e.z[3],e.x[4],e.y[4],e.z[4],e.x[5],e.y[5],e.z[5]):z==="back"&&n.push(e.x[0],e.y[0],e.z[0],e.x[2],e.y[2],e.z[2],e.x[1],e.y[1],e.z[1],e.x[3],e.y[3],e.z[3],e.x[5],e.y[5],e.z[5],e.x[4],e.y[4],e.z[4])}}super(n)}};var lt=0,W=class{constructor(t,s,o){let r=this._createShader(t,t.VERTEX_SHADER,s),i=this._createShader(t,t.FRAGMENT_SHADER,o);this.gl=t,this.id=lt++,this.program=this._createProgram(t,r,i),this.uniforms={uMatrix:{name:"uMatrix",value:null,type:"mat4"}}}_createShader(t,s,o){let r=t.createShader(s);if(t.shaderSource(r,o),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))return r;console.log(t.getShaderInfoLog(r)),t.deleteShader(r)}_createProgram(t,s,o){let r=t.createProgram();if(t.attachShader(r,s),t.attachShader(r,o),t.linkProgram(r),t.getProgramParameter(r,t.LINK_STATUS))return r;console.log(t.getProgramInfoLog(r)),t.deleteProgram(r)}setUniform(t,s,o){this.uniforms[t]={name:t,value:s,type:o}}};var h=class{static createColor(t,s,o){return{r:t/255,g:s/255,b:o/255}}};h.Renderer=G;h.Orthographic=O;h.Volume=Y;h.Mesh=H;h.Geometry=P;h.Plane=V;h.Circle=X;h.Cube=N;h.Program=W;var S=window.innerWidth/window.innerHeight,ut=document.getElementById("webgl"),C=new h.Renderer(ut),ft=new h.Circle(.25,64),mt=new h.Program(C.gl,J,Q),st=new h.Mesh(ft,mt);st.setPosition(0,0,.3);var dt=new h.Cube(.5,.5,.5,64,64,64),et=new h.Program(C.gl,$,tt);et.setUniform("uTime",0,"1f");var q=new h.Mesh(dt,et);q.setRotationX(37.5);q.setRotationY(45);var Z=new h.Volume;Z.add(q);Z.add(st);var K=new h.Orthographic(-1*S,1*S,-1,1,-1,1);C.resize();C.gl.clearColor(0,0,0,0);var ot=0,rt=()=>{C.render(Z,K),ot+=.1,q.shader.uniforms.uTime.value=ot,window.requestAnimationFrame(rt)};window.addEventListener("resize",()=>{C.resize()&&(S=C.gl.canvas.width/C.gl.canvas.height,K.setLeft(-1*S),K.setRight(1*S))});window.requestAnimationFrame(rt);})();
